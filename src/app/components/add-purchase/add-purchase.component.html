<div class="container">
  <div class="form-card">
    <div class="card-header">
      <h2 class="form-title">
        <i class="fas fa-cart-plus"></i> Add New Purchase
      </h2>
    </div>
    
    <form [formGroup]="purchaseForm" (ngSubmit)="onSubmit()" class="purchase-form">
      <div class="form-grid">
        <div class="form-group">
          <label for="productId">
            <i class="fas fa-box"></i> Select Product <span class="required">*</span>
          </label>
          <select 
            id="productId" 
            formControlName="productId" 
            class="form-control"
            [class.is-invalid]="isFieldInvalid('productId')"
          >
            <option value="">Select Product</option>
            <option *ngFor="let product of products" [value]="product.id">
              {{ product.name }}
            </option>
          </select>
          <div class="invalid-feedback" *ngIf="isFieldInvalid('productId')">
            Product is required
          </div>
        </div>

        <div class="form-group">
          <label for="quantity">
            <i class="fas fa-hashtag"></i> Quantity <span class="required">*</span>
          </label>
          <input 
            type="number" 
            id="quantity" 
            formControlName="quantity" 
            class="form-control"
            [class.is-invalid]="isFieldInvalid('quantity')"
            min="1"
          >
          <div class="invalid-feedback" *ngIf="getFieldError('quantity')">
            {{ getFieldError('quantity') }}
          </div>
        </div>

        <div class="form-group">
          <label for="unitPrice">
            <i class="fas fa-tag"></i> Unit Price <span class="required">*</span>
          </label>
          <div class="input-group">
            <span class="input-group-text">₹</span>
            <input 
              type="number" 
              id="unitPrice" 
              formControlName="unitPrice" 
              class="form-control"
              [class.is-invalid]="isFieldInvalid('unitPrice')"
              min="0.01"
              step="0.01"
            >
          </div>
          <div class="invalid-feedback" *ngIf="getFieldError('unitPrice')">
            {{ getFieldError('unitPrice') }}
          </div>
        </div>

        <div class="form-group">
          <label for="purchaseDate">
            <i class="fas fa-calendar"></i> Purchase Date <span class="required">*</span>
          </label>
          <input 
            type="datetime-local" 
            id="purchaseDate" 
            formControlName="purchaseDate" 
            class="form-control"
            [class.is-invalid]="isFieldInvalid('purchaseDate')"
          >
        </div>

        <div class="form-group">
          <label for="invoiceNumber">
            <i class="fas fa-file-invoice"></i> Invoice Number <span class="required">*</span>
          </label>
          <input 
            type="text" 
            id="invoiceNumber" 
            formControlName="invoiceNumber" 
            class="form-control"
            [class.is-invalid]="isFieldInvalid('invoiceNumber')"
          >
          <div class="invalid-feedback" *ngIf="isFieldInvalid('invoiceNumber')">
            Invoice number is required
          </div>
        </div>

        <div class="form-group">
          <label for="otherExpenses">
            <i class="fas fa-coins"></i> Other Expenses
          </label>
          <div class="input-group">
            <span class="input-group-text">₹</span>
            <input 
              type="number" 
              id="otherExpenses" 
              formControlName="otherExpenses" 
              class="form-control"
              [class.is-invalid]="isFieldInvalid('otherExpenses')"
              min="0"
              step="0.01"
            >
          </div>
          <div class="invalid-feedback" *ngIf="getFieldError('otherExpenses')">
            {{ getFieldError('otherExpenses') }}
          </div>
        </div>
      </div>

      <div class="form-actions">
        <button 
          type="button" 
          class="btn btn-secondary"
          (click)="resetForm()"
          [disabled]="loading"
        >
          <i class="fas fa-undo"></i> Reset
        </button>
        <button 
          type="submit" 
          class="btn btn-primary"
          [disabled]="purchaseForm.invalid || loading"
        >
          <i class="fas" [ngClass]="loading ? 'fa-spinner fa-spin' : 'fa-save'"></i>
          {{ loading ? 'Saving...' : 'Save Purchase' }}
        </button>
      </div>
    </form>
  </div>
</div>

<app-loader *ngIf="loading"></app-loader>
